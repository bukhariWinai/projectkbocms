{% extends 'cmsapp_backend/backend_base.html' %}
{% load static %}
{% block content %}
<section class="section">
  <div class="row justify-content-start">
    <div class="col-lg-12">
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
           <h5 class="mb-0">
            <span><i class="bi bi-list-check"></i> ทะเบียนนักศึกษาฝึกงาน</span>
          </h5>
          {% if user.profileuser.usergroup == "admin" %}
          <a href="{% url 'showalltrainee_page' %}" class="btn btn-light btn-sm shadow-sm">
            <i class="bi bi-people-fill"></i> ดูทั้งหมด
          </a>
          {% endif %}
         
        </div>
        <div class="card-body">

          <div class="table-responsive">
            <table class="table table-striped align-middle datatable">
              <thead class="table-light text-center">
                <tr>
                  <th><i class="bi bi-person"></i> คำนำหน้า</th>
                  <th><i class="bi bi-person-badge"></i> ชื่อ</th>
                  <th><i class="bi bi-person-badge"></i> นามสกุล</th>
                  <th><i class="bi bi-building"></i> สถาบัน</th>
                  <th><i class="bi bi-bar-chart-steps"></i> ระดับชั้น</th>
                  <th><i class="bi bi-journal-code"></i> สาขาวิชา</th>
                  <th><i class="bi bi-stars"></i> ทักษะพิเศษ</th>
                  <th><i class="bi bi-calendar-check"></i> เริ่มฝึก</th>
                  <th><i class="bi bi-calendar-x"></i> สิ้นสุด</th>
                  <th><i class="bi bi-image"></i> รูปถ่าย</th>
                </tr>
              </thead>
              <tbody class="text-center">
                <tr>
                  <td>{{ trainee.title_name }}</td>
                  <td>
                    <a href="{% url 'traineedetails_page' trainee.id %}" class="text-decoration-none fw-semibold">
                      {{ trainee.Trainee_firstname }}
                    </a>
                  </td>
                  <td>{{ trainee.Trainee_lastname }}</td>
                  <td>{{ trainee.Trainee_school }}</td>
                  <td>{{ trainee.Trainee_degree }}</td>
                  <td>{{ trainee.subject }}</td>
                  <td>{{ trainee.subject_ability }}</td>
                  <td>{{ trainee.Training_start }}</td>
                  <td>{{ trainee.Training_finish }}</td>
                  <td>
                    <img src="{{ trainee.photograph.url }}"
                         class="rounded shadow-sm"
                         width="100" height="80"
                         style="cursor: pointer;"
                         data-bs-toggle="modal"
                         data-bs-target="#imageModal"
                         onclick="showFullImage('{{ trainee.photograph.url }}')">
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>
      </div>
    </div>
  </div>
</section>

<!-- Modal สำหรับแสดงรูปภาพขนาดเต็ม -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content border-0 shadow-lg rounded-4">
      
      <!-- Header -->
      <div class="modal-header bg-light border-0 rounded-top-4 px-4">
        <h5 class="modal-title text-dark" id="imageModalLabel">
          <i class="bi bi-image"></i> แสดงรูปภาพ
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <!-- Body -->
      <div class="modal-body text-center bg-white rounded-bottom-4 px-4 py-3">
        <img id="modalImage" 
             src="" 
             class="img-fluid rounded-3 shadow-sm border" 
             style="max-height: 75vh; object-fit: contain;">
      </div>
    </div>
  </div>
</div>


<script>
function showFullImage(imageUrl) {
  const timestamp = new Date().getTime();
  document.getElementById('modalImage').src = imageUrl + '?t=' + timestamp;
}
</script>



{% endblock content %}



